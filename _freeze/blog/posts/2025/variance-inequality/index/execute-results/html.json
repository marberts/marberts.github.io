{
  "hash": "106be2e24808a0903cbef75a800c9972",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How does the difference between the arithmetic and geometric mean depend on variance?\"\ndate: \"2025-11-12\"\ncategories:\n  - Inequalities\n  - Index numbers\n  - R\ndescription: It's well known that the arithmetic mean is larger than the geometric mean, but how does the difference between these means relate to variance?\n---\n\nThat the arithmetic mean of a set of number is larger than the geometric mean is a foundational result in the theory of inequalities. This is a useful result for index numbers in particular as it gives that, for the same data, an index based on an arithmetic mean will always be larger than the corresponding index based on the geometric mean.\n\nThe latest edition of the CPI manual says the following about the difference between the arithmetic and geometric mean and how it relates to variance [@cpi2020, p. 2]\n\n> It should be noted that an arithmetic average is always greater than or equal to a geometric average and that the difference will be greater, the greater the variance in the price relatives.\n\nThis seems like a great result that gives a way to easily think about the relationship between an index that uses an arithmetic mean to aggregate price relatives (Carli index) and one that uses a geometric mean (Jevons index). Unfortunately it's not true---see @lord2002 for a neat way to generate counter examples. [^1]\n\n[^1]: This can also apply to the difference between the arithmetic mean and harmonic mean, where it is often suggested that the difference between these means increases with variance [@cpitheory, p. 131].\n\nThe issue is that, for a vector of positive numbers $x\\in\\mathbf{R}_{n}^{++}$, the difference between the arithmetic mean $\\mathfrak{A}(x)$ and geometric mean $\\mathfrak{G}(x)$ is only *bounded* by the variance [@bullen2003, p. 156]\n\n$$\n\\frac{\\text{var}(x)}{2 \\max(x)} \\leq \\mathfrak{A}(x) - \\mathfrak{G}(x) \\leq \\frac{\\text{var}(x)}{2 \\min(x)}.\n$$\n\nFor two vectors $x$ and $y$, we have that $\\mathfrak{A}(y) - \\mathfrak{G}(y) > \\mathfrak{A}(x) - \\mathfrak{G}(x)$ if\n\n$$\n\\text{var}(y) > \\frac{\\max(y)}{\\min(x)}\\text{var}(x)\n$$ {#eq-ineq1}\n\nand the opposite if\n\n$$\n\\text{var}(y) < \\frac{\\min(y)}{\\max(x)}\\text{var}(x)\n$$ {#eq-ineq2}\n\nIf $\\max(y) > \\min(x)$ (what we should expect) then the difference between the arithmetic and geometric mean increases with a sufficiently large increase in variance. Similarly, if $\\min(y) < \\max(x)$ then the difference between the arithmetic and geometric mean decreases with a sufficiently large decrease in variance. If the support of the distribution is sufficiently narrow then the difference between the arithmetic and geometric mean will follow closely with the variance, and this is similar to the argument that generates the claim in the CPI manual [@cpitheory, p. 131].\n\nWhat I want to understand is how the difference between the arithmetic and geometric mean changes for *smaller* changes in variance without placing restrictions on the support of the distribution. Let's consider drawing a collection of samples from a fixed probability distribution to see how the difference between the arithmetic and geometric mean relates to variance among samples from that distribution. We'll make a few helper functions for this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar_ineq <- function(x) {\n  m <- mean(x)\n  c(\n    var = mean((x - m)^2),\n    diff = m - exp(mean(log(x))),\n    min = min(x),\n    max = max(x)\n  )\n}\n\nsimulate_var_ineq <- function(n, sim, dist) {\n  res <- apply(matrix(dist(n * sim), nrow = n), 2, var_ineq)\n  res[, order(res[\"var\", ])]\n}\n\nprob_decrease <- function(x) {\n  apply(\n    x,\n    2,\n    \\(z) {\n      cond <- x[\"var\", ] <= x[\"max\", ] / z[\"min\"] * z[\"var\"] |\n        x[\"var\", ] >= x[\"min\", ] / z[\"max\"] * z[\"var\"]\n      x <- x[, cond]\n      decrease <- x[\"diff\", ] < z[\"diff\"] & x[\"var\", ] > z[\"var\"]\n      increase <- x[\"diff\", ] > z[\"diff\"] & x[\"var\", ] < z[\"var\"]\n\n      mean(decrease | increase) * 100\n    }\n  )\n}\n```\n:::\n\n\nThe scatter plot of the difference between the arithmetic and geometric mean and variance for a sample of size 10 shows that, although the difference tends to increase with variance, there are several instances where the opposite occurs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(15243)\n\nsim <- simulate_var_ineq(10, 100, \\(n) rlnorm(n, sdlog = 0.25))\n\nplot(t(sim), ylab = \"arithmetic mean - geometric mean\", xlab = \"variance\")\nsymbols(0.13, 0.05, circles = 0.015, inches = FALSE, add = TRUE, lty = 2)\nsymbols(0.065, 0.03, circles = 0.01, inches = FALSE, add = TRUE, lty = 2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nTo better understand this, let's simulate the probability that the difference between the arithmetic and geometric mean decreases with variance, conditional on @eq-ineq1 and @eq-ineq2 not holding.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- simulate_var_ineq(10, 5000, \\(n) rlnorm(n, sdlog = 0.25)) |>\n  prob_decrease()\n\nsummary(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   4.400   6.340   6.562   8.020  35.160 \n```\n\n\n:::\n:::\n\n\nOverall, the median of the conditional probability that the difference between the arithmetic and geometric mean decreases with variance is about 6.3%. This is a fairly small probability for the difference between the means to decrease when variance increases, although it depends on the underlying population from which samples are drawn. Drawing samples from a distribution with a wider support makes it more likely to see the the difference between the arithmetic and geometric mean decreases with variance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- simulate_var_ineq(10, 5000, \\(n) runif(n, 0.25, 4)) |>\n  prob_decrease()\n\nsummary(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.020   8.515  13.400  13.579  17.100  50.580 \n```\n\n\n:::\n:::\n\n\nAs the support of the distribution shrinks, the difference between the arithmetic and geometric mean follows the variance more closely and the probabiltity that the difference in means decreases as variance increases becomes small.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- simulate_var_ineq(10, 5000, \\(n) runif(n, 0.9, 1 / 0.9)) |>\n  prob_decrease()\n\nsummary(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.800   1.140   1.194   1.500   4.560 \n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}